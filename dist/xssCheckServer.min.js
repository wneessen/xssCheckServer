"use strict";var wpObj=require("webpage").create(),wsObj=require("webserver").create(),debugMode=!0,versionNum="1.0.1";wpObj.settings.userAgent="Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/85.0.4183.102 Safari/537.36 xssCheckServer/"+versionNum,wpObj.settings.XSSAuditingEnabled=!1,wpObj.settings.webSecurityEnabled=!1,wpObj.settings.loadImages=!0,wpObj.settings.javascriptEnabled=!0,wpObj.settings.localToRemoteUrlAccessEnabled=!0,wpObj.settings.resourceTimeout=5e3;var listenHost="127.0.0.1",listenPort="8099";console.log("This is xssCheckServer v"+versionNum),console.log("Starting webserver on http://"+listenHost+":"+listenPort);var webService=wsObj.listen(listenHost+":"+listenPort,function(e,o){var s=new Date,t="XSSed!",n={hasXss:!1,xssData:[],checkUrl:"",checkTime:s,searchString:""},r=function(e,o){debugMode&&(console.log("An event has been executed on "+l),console.log('==> EventType: "'+e+'" // EventData: "'+o+'"')),o===t&&(debugMode&&console.log('Possible XSS! The eventMsg matches the search string: "'+t+'"\n'),n.hasXss=!0,n.xssData.push({eventType:e,eventMsg:o}))};if(wpObj.onAlert=function(e){r("alert()",e)},wpObj.onConsoleMessage=function(e){r("console.log()",e)},wpObj.onPrompt=function(e){r("prompt()",e)},wpObj.onConfirm=function(e){r("confirm()",e)},wpObj.onError=debugMode?function(){}:function(e){console.error("An error was caught: "+e)},debugMode&&(console.log("Received new HTTP request"),console.log("Method: "+e.method),console.log("Path: "+e.url),e.post&&console.log("postData: "+JSON.stringify(e.post)),console.log(" ")),"/check"===e.url)if("POST"===e.method)if(e.post.searchfor&&(t=e.post.searchfor,n.searchString=t),e.post.url){var l=e.post.url;n.checkUrl=l,wpObj.open(l,function(e){"success"!==e?console.error("Unable to download URL: "+l):wpObj.evaluate(function(){}),o.statusCode=200,o.write(JSON.stringify(n)),o.close()})}else o.statusCode=400,o.write("Missing data"),o.close();else o.statusCode=404,o.write("File not allowed"),o.close();else o.statusCode=404,o.write("File not found"),o.close()});